<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record
        id="edi_exchange_template_outbound_instruction"
        model="edi.exchange.template.output"
    >
        <field name="name">EDI Exchange - GS1 Outbound Instruction</field>
        <field name="code">gs1.generate.warehousingOutboundInstruction</field>
        <field name="output_type">xml</field>
        <field name="backend_type_id" ref="edi_gs1.backend_type_gs1" />
        <field name="type_id" ref="edi_exchange_type_outbound_instruction" />
        <field name="template_id" ref="edi_exchange_outbound_instruction" />
        <field name="code_snippet">
sender = backend.lsc_partner_id
receiver = exchange_record.record.partner_id
shipto = exchange_record.record.partner_id
logistic_service_seller = backend.lsp_partner_id
logistic_service_buyer = sender
# FIXME: this is probably wrong or not always true
buyer = exchange_record.record.partner_id
# TODO: Pick the SO partner customer.
seller = backend.lsc_partner_id
# TODO: get a default carrier somehow?
shipper = exchange_record.record.carrier_id.partner_id

_result = {
    "sender": sender,
    "receiver": receiver,
    "ls_seller": logistic_service_seller,
    "ls_buyer": logistic_service_buyer,
    "buyer": buyer,
    "seller": seller,
    "shipper": shipper,
    "shipto": shipto,
}

provider = get_info_provider(exchange_record, work_ctx=_result)
if provider:
    _result["info"] = provider.generate_info()

result = _result
        </field>
    </record>

    <record
        id="edi_exchange_template_outbound_notification_ack"
        model="edi.exchange.template.output"
    >
        <field name="name">EDI Exchange - GS1 Outbound Notification ACK</field>
        <field name="code">gs1.generate.warehousingOutboundInstructionAck</field>
        <field name="output_type">xml</field>
        <field name="backend_type_id" ref="edi_gs1.backend_type_gs1" />
        <field name="type_id" ref="edi_gs1.edi_exchange_type_receipt_ack_out" />
        <field name="template_id" ref="edi_gs1.edi_exchange_business_header" />
        <field name="code_snippet">
sender = backend.lsc_partner_id
receiver = exchange_record.record.partner_id
shipto = exchange_record.record.partner_id
logistic_service_seller = backend.lsp_partner_id
logistic_service_buyer = sender
# FIXME: this is probably wrong or not always true
buyer = exchange_record.record.partner_id
# TODO: Pick the SO partner customer.
seller = backend.lsc_partner_id
# TODO: get a default carrier somehow?
shipper = env['res.partner'].new({
    'name': "NO_CARRIER_SPECIFIED",
    'gln_code': "0" * 13,
})

_result = {
    "sender": sender,
    "receiver": receiver,
    "ls_seller": logistic_service_seller,
    "ls_buyer": logistic_service_buyer,
    "buyer": buyer,
    "seller": seller,
    "shipper": shipper,
    "shipto": shipto,
}

provider = get_info_provider(exchange_record, work_ctx=_result)
if provider:
    _result["info"] = provider.generate_info()

result = _result
        </field>
    </record>
</odoo>
